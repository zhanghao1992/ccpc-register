!function(e){"function"==typeof define&&define.amd?define(["Zepto"],function(t){e(t)}):"function"==typeof define&&define.cmd?define(["Zepto"],function(t){e(t("Zepto"))}):e(Zepto)}(function(e){var t=['input:not([type]),input[type="color"],input[type="date"],input[type="datetime"],input[type="datetime-local"],input[type="email"],input[type="file"],input[type="hidden"],input[type="month"],input[type="number"],input[type="password"],input[type="range"],input[type="search"],input[type="tel"],input[type="text"],input[type="time"],input[type="url"],input[type="week"],textarea',"select",'input[type="checkbox"],input[type="radio"]'],i=t.join(","),n={},a=function(e,t,i){if("radio"==e.prop("type")||"checkbox"==e.prop("type")){var n=i.$form.find('[name="'+e.prop("name")+'"]');n.filter(":checked").length>0?n.removeClass("field-invalid"):n.addClass("field-invalid")}else t.required&&t.pattern&&t.conditional?e.removeClass("field-invalid"):e.addClass("field-invalid")},o=function(){function t(t){if(!i){var n=e('<div class="field-tooltipWrap"><div class="field-tooltipInner"><div class="field-tooltip fieldTipBounceIn">'+t+"</div></div></div>");n.appendTo(e("body")),i=!0,setTimeout(function(){n.remove(),i=!1},1500)}}var i=null;return{show:t}}(),d=function(i,d){var l,r=e(this),p={required:!0,conditional:!0,pattern:!0},c=e.fn.mvalidate.errorTipFormat,u=e.trim(r.val())||"",s=r.attr("data-validate"),f=void 0!=s?n[s]:{},v=r.attr("data-required"),m=r.attr("data-pattern")||("regexp"==e.type(f.pattern)?f.pattern:/(?:)/),y=r.attr("data-conditional")||f.conditional,h=r.attr("data-descriptions")||f.descriptions,g=r.attr("data-describedby")||f.describedby;h=e.isPlainObject(h)?h:d.descriptions[h]||{},v=""!=v?v||!!f.required:!0,"regexp"!=e.type(m)&&(m=RegExp(m)),v&&(r.is(t[0]+","+t[1])?!u.length>0&&(p.required=!1):r.is(t[2])&&(r.is("[name]")?0==d.$form.find('[name="'+r.prop("name")+'"]:checked').length&&(p.required=!1):p.required=field.is(":checked"))),r.is(t[0])&&(m.test(u)||(v?p.pattern=!1:u.length>0&&(p.pattern=!1))),"undefined"!=y&&(e.isFunction(y)?p.conditional=!!y.call(r,u,d):d.conditional.hasOwnProperty(y)&&!d.conditional[y].call(r,u,d)&&(p.conditional=!1)),l=c(h.valid),p.required?p.pattern?p.conditional||(l=c(h.conditional)):l=c(h.pattern):l=c(h.required);var F=e('[id="'+g+'"]');return F.length>0&&2==d.type&&("keyup"!=i.type&&"change"!=i.type||F.children().length&&e.trim(F.text()))&&(F.html(l||""),a(r,p,d)),"function"==typeof f.each&&f.each.call(r,i,p,d),d.eachField.call(r,i,p,d),p.required&&p.pattern&&p.conditional?("function"==typeof f.valid&&f.valid.call(r,i,p,d),d.eachValidField.call(r,i,p,d)):(!d.firstInvalid&&d.firstInvalidFocus&&(d.firstInvalid=!0,r.focus()),1==d.type&&o.show(l),"function"==typeof f.invalid&&f.invalid.call(r,i,p,d),d.eachInvalidField.call(r,i,p,d)),p};e.extend(e,{mvalidateExtend:function(t){return e.extend(n,t)}}),e.fn.mvalidate=function(n){var a,o={type:1,validateInSubmit:!0,sendForm:!0,onKeyup:!1,onChange:!0,firstInvalidFocus:!0,conditional:{},descriptions:{},eachField:e.noop,eachValidField:e.noop,eachInvalidField:e.noop,valid:e.noop,invalid:e.noop,namespace:"mvalidate"},l=e.extend(!0,o,n),r=l.namespace;return l.type=Number(l.type),l.firstInvalid=!1,a=1==l.type?!1:!0,this.mvalidateDestroy().each(function(){var n,o=e(this);o.is("form")&&(l.$form=o,o.data(name,{options:l}),n=o.find(i),a&&l.onKeyup&&n.filter(t[0]).each(function(){e(this).on("keyup."+r,function(e){d.call(this,e,l)})}),a&&l.onChange&&n.each(function(){var i=e(this);i.is(t[1]+","+t[2])&&e(this).on("change."+r,function(e){d.call(this,e,l)})}),l.validateInSubmit&&o.on("submit."+r,function(t){var i=!0;l.firstInvalid=!1,n.each(function(){var e=d.call(this,t,l);e.pattern&&e.conditional&&e.required||(i=!1)}),i?(l.sendForm||t.preventDefault(),e.isFunction(l.valid)&&l.valid.call(o,t,l)):(t.preventDefault(),t.stopImmediatePropagation(),e.isFunction(l.invalid)&&l.invalid.call(o,t,l))}))})},e.fn.mvalidateDestroy=function(){var t,n=e(this),a=n.data(name);return n.is("form")&&e.isPlainObject(a)&&"string"==typeof a.options.namespace&&(t=n.removeData(name).find(i),t.off("."+a.options.namespace)),n},e.fn.mvalidate.errorTipFormat=function(e){return'<div class="zvalid-resultformat">'+e+"</div>"}});